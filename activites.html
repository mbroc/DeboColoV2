<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Activités à venir</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Roboto', sans-serif;
    background: #f7f9fc;
    margin: 0;
    padding: 20px;
  }
  h1 {
    text-align: center;
    color: #333;
  }
  .activity {
    background: #fff;
    border-left: 6px solid #4CAF50;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin: 20px auto;
    max-width: 600px;
    padding: 15px 20px;
    border-radius: 8px;
  }
  .activity:nth-child(even) {
    border-left-color: #2196F3;
  }
  .activity p {
    margin: 6px 0;
    color: #555;
  }
  .highlight {
    font-weight: bold;
    color: #222;
  }
  .loader {
    text-align: center;
    margin-top: 50px;
    font-size: 18px;
    color: #888;
  }
</style>
</head>
<body>

<h1>Activités à venir 1111</h1>

<div id="loader" class="loader">Chargement des activités…</div>
<div id="activities"></div>

<script>
//const sheetURL = "https://spreadsheets.google.com/feeds/list/1cLlpmX1vZTMyD7ED1AxMAs7tFGn8P7N5dqVbGSUUtl4/od6/public/values?alt=json";
const sheetURL = "https://spreadsheets.google.com/feeds/list/1cLlpmX1vZTMyD7ED1AxMAs7tFGn8P7N5dqVbGSUUtl4/od6/public/values?alt=json";


fetch(sheetURL)
  .then(response => response.json())
  .then(data => {
    const rows = data.feed.entry;
    const container = document.getElementById("activities");
    const loader = document.getElementById("loader");
    loader.style.display = "none";

    if (!rows || rows.length === 0) {
      container.innerHTML = "<p>Aucune activité disponible pour le moment.</p>";
      return;
    }

    // Tableau d'objets plus simple + tri sur la date
    const activities = rows.map(row => ({
      date: row.gsx$date.$t,
      name: row.gsx$nomdelactivité.$t,
      desc: row.gsx$description.$t,
      budget: row.gsx$budget.$t,
      maxP: row.gsx$maxparticipants.$t,
      currentP: row.gsx$inscriptionsactuelles.$t
    }));

    activities.sort((a, b) => new Date(a.date.split("/").reverse().join("-")) - new Date(b.date.split("/").reverse().join("-")));

    activities.forEach(act => {
      const html = `
      <div class="activity">
        <p><span class="highlight">Date :</span> ${act.date}</p>
        <p><span class="highlight">Activité :</span> ${act.name}</p>
        <p><span class="highlight">Description :</span> ${act.desc}</p>
        <p><span class="highlight">Budget estimé :</span> ${act.budget} €</p>
        <p><span class="highlight">Jusqu'à</span> ${act.maxP} participants</p>
        <p><span class="highlight">Déjà inscrits :</span> ${act.currentP}</p>
      </div>`;
      container.insertAdjacentHTML("beforeend", html);
    });
  })
  .catch(error => {
    console.error(error);
    document.getElementById("loader").innerHTML =
      "<p>Erreur lors du chargement des activités.</p>";
  });
</script>

</body>
</html>
